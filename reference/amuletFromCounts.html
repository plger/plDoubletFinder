<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>amuletFromCounts — amuletFromCounts • scDblFinder</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="amuletFromCounts — amuletFromCounts"><meta name="description" content="A reimplementation of the Amulet doublet detection method for single-cell
ATACseq (Thibodeau, Eroglu, et al., Genome Biology 2021), based on tile/peak
counts. Note that this is only a fast approximation to the original Amulet
method, and *performs considerably worse*; for an equivalent implementation,
see amulet."><meta property="og:description" content="A reimplementation of the Amulet doublet detection method for single-cell
ATACseq (Thibodeau, Eroglu, et al., Genome Biology 2021), based on tile/peak
counts. Note that this is only a fast approximation to the original Amulet
method, and *performs considerably worse*; for an equivalent implementation,
see amulet."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-dark" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">scDblFinder</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.19.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/scDblFinder.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/computeDoubletDensity.html">Scoring potential doublets from simulated densities</a></li>
    <li><a class="dropdown-item" href="../articles/findDoubletClusters.html">Detecting clusters of doublet cells with DE analyses</a></li>
    <li><a class="dropdown-item" href="../articles/introduction.html">Introduction to the scDblFinder package</a></li>
    <li><a class="dropdown-item" href="../articles/recoverDoublets.html">Recovering intra-sample doublets</a></li>
    <li><a class="dropdown-item" href="../articles/scATAC.html">Doublet identifiation in single-cell ATAC-seq</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/plger/scDblFinder/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>amuletFromCounts</h1>
      <small class="dont-index">Source: <a href="https://github.com/plger/scDblFinder/blob/devel/R/atac.R" class="external-link"><code>R/atac.R</code></a></small>
      <div class="d-none name"><code>amuletFromCounts.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>A reimplementation of the Amulet doublet detection method for single-cell
ATACseq (Thibodeau, Eroglu, et al., Genome Biology 2021), based on tile/peak
counts. Note that this is only a fast approximation to the original Amulet
method, and *performs considerably worse*; for an equivalent implementation,
see <code><a href="amulet.html">amulet</a></code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">amuletFromCounts</span><span class="op">(</span><span class="va">x</span>, maxWidth <span class="op">=</span> <span class="fl">500L</span>, exclude <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"chrM"</span>, <span class="st">"M"</span>, <span class="st">"Mt"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>A `SingleCellExperiment` object, or a matrix of counts with cells
as columns. If the rows represent peaks, it is recommended to limite their
width (see details).</p></dd>


<dt id="arg-maxwidth">maxWidth<a class="anchor" aria-label="anchor" href="#arg-maxwidth"></a></dt>
<dd><p>the maximum width for a feature to be included. This is
ignored unless `x` is a `SingleCellExperiment` with `rowRanges`.</p></dd>


<dt id="arg-exclude">exclude<a class="anchor" aria-label="anchor" href="#arg-exclude"></a></dt>
<dd><p>an optional `GRanges` of regions to be excluded. This is
ignored unless `x` is a `SingleCellExperiment` with `rowRanges`.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>If `x` is a `SingleCellExperiment`, returns the object with an
additional `amuletFromCounts.q` colData column. Otherwise returns a vector of
 the amulet doublet q-values for each cell.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The rationale for the amulet method is that a single diploid cell should not
have more than two reads covering a single genomic location, and the method
looks for cells enriched with sites covered by more than two reads.
If the method is applied on a peak-level count matrix, however, larger peaks
can however contain multiple reads even though no single nucleotide is
covered more than once. Therefore, in such case we recommend to limit the
width of the peaks used for this analysis, ideally to maximum twice the upper
bound of the fragment size. For example, with a mean fragment size of 250bp
and standard deviation of 125bp, peaks larger than 500bp are very likely to
contain non-overlapping fragments, and should therefore be excluded using the
`maxWidth` argument.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="amulet.html">amulet</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="mockDoubletSCE.html">mockDoubletSCE</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">amuletFromCounts</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span>call<span class="op">=</span><span class="va">x</span><span class="op">$</span><span class="va">amuletFromCounts.q</span><span class="op">&lt;</span><span class="fl">0.05</span>, truth<span class="op">=</span><span class="va">x</span><span class="op">$</span><span class="va">type</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        truth</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> call    singlet doublet</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   FALSE     500       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   TRUE        0      22</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Pierre-Luc Germain.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

