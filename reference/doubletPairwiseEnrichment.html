<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>doubletPairwiseEnrichment — doubletPairwiseEnrichment • scDblFinder</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="doubletPairwiseEnrichment — doubletPairwiseEnrichment"><meta name="description" content="Calculates enrichment in any type of doublet (i.e. specific combination of
clusters) over random expectation.
Note that when applied to an multisample object, this functions assumes that
the cluster labels match across samples."><meta property="og:description" content="Calculates enrichment in any type of doublet (i.e. specific combination of
clusters) over random expectation.
Note that when applied to an multisample object, this functions assumes that
the cluster labels match across samples."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-dark" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">scDblFinder</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.19.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/scDblFinder.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/computeDoubletDensity.html">Scoring potential doublets from simulated densities</a></li>
    <li><a class="dropdown-item" href="../articles/findDoubletClusters.html">Detecting clusters of doublet cells with DE analyses</a></li>
    <li><a class="dropdown-item" href="../articles/introduction.html">Introduction to the scDblFinder package</a></li>
    <li><a class="dropdown-item" href="../articles/recoverDoublets.html">Recovering intra-sample doublets</a></li>
    <li><a class="dropdown-item" href="../articles/scATAC.html">Doublet identifiation in single-cell ATAC-seq</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/plger/scDblFinder/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>doubletPairwiseEnrichment</h1>
      <small class="dont-index">Source: <a href="https://github.com/plger/scDblFinder/blob/devel/R/enrichment.R" class="external-link"><code>R/enrichment.R</code></a></small>
      <div class="d-none name"><code>doubletPairwiseEnrichment.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Calculates enrichment in any type of doublet (i.e. specific combination of
clusters) over random expectation.
Note that when applied to an multisample object, this functions assumes that
the cluster labels match across samples.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">doubletPairwiseEnrichment</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  lower.tail <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  sampleWise <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"poisson"</span>, <span class="st">"binomial"</span>, <span class="st">"nbinom"</span>, <span class="st">"chisq"</span><span class="op">)</span>,</span>
<span>  inclDiff <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>A table of double statistics, or a SingleCellExperiment on which
scDblFinder was run using the cluster-based approach.</p></dd>


<dt id="arg-lower-tail">lower.tail<a class="anchor" aria-label="anchor" href="#arg-lower-tail"></a></dt>
<dd><p>Logical; defaults to FALSE to test enrichment (instead of
depletion).</p></dd>


<dt id="arg-samplewise">sampleWise<a class="anchor" aria-label="anchor" href="#arg-samplewise"></a></dt>
<dd><p>Logical; whether to perform tests sample-wise in multi-sample
datasets. If FALSE (default), will aggregate counts before testing.</p></dd>


<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>Type of test to use.</p></dd>


<dt id="arg-incldiff">inclDiff<a class="anchor" aria-label="anchor" href="#arg-incldiff"></a></dt>
<dd><p>Logical; whether to regress out any effect of the
identification difficulty in calculating expected counts</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>Logical; whether to output eventual warnings/notes</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A table of significances for each combination.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">sce</span> <span class="op">&lt;-</span> <span class="fu"><a href="mockDoubletSCE.html">mockDoubletSCE</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sce</span> <span class="op">&lt;-</span> <span class="fu"><a href="scDblFinder.html">scDblFinder</a></span><span class="op">(</span><span class="va">sce</span>, clusters<span class="op">=</span><span class="cn">TRUE</span>, artificialDoublets<span class="op">=</span><span class="fl">500</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Some cells in `sce` have an extremely low read counts; note that these could trigger errors and might best be filtered out</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Clustering cells...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 4 clusters</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Creating ~500 artificial doublets...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Dimensional reduction</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Evaluating kNN...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Training model...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> iter=0, 17 cells excluded from training.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> iter=1, 17 cells excluded from training.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> iter=2, 17 cells excluded from training.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Threshold found:0.814</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 17 (3.2%) doublets called</span>
<span class="r-in"><span><span class="fu">doubletPairwiseEnrichment</span><span class="op">(</span><span class="va">sce</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> theta=0.0982616714523507</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   combination  log2enrich      p.value          FDR</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3         2+3  1.50334955 0.0001418108 0.0008508647</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5         2+4  0.09494413 0.2175146578 1.0000000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1         1+2  0.20678984 0.2466576257 1.0000000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2         1+3 -2.02625514 1.0000000000 1.0000000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4         1+4 -0.97004127 1.0000000000 1.0000000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6         3+4 -0.60094404 1.0000000000 1.0000000000</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Pierre-Luc Germain.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

